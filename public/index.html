<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home - Chatbot</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="chat-container-home">
      <h1 class= "home_text">Welcome to our study!</h1>
	  <div class="logo_container">
	  <img src="images/usfca.svg" class="usfca"alt="">
	  </div>
      <p class= "home_text">
        Thank you for participating in our CS-486-01 study!
      </p>
	  <form id="participant-form" action="/study.html" class= "home_text">
  <label for="participantID">Please enter your Participant ID:</label>
  <input type="text" id="participantID" name="participantID" required>
  <button type="submit" class="button">Start Chat</button>
</form>
    </div>
	      <script>
        document.getElementById('participant-form').addEventListener('submit', function(event) {
          event.preventDefault(); // Prevent form from submitting

          const participantID = document.getElementById('participantID').value;
          if (!participantID) {
            alert("Please enter your Participant ID");
            return;
          }

          // Save the Participant ID in localStorage
          localStorage.setItem('participantID', participantID);

          // Send participantID to the server to fetch data
          fetch(`/get-participant-data?participantID=${participantID}`)
            .then(response => response.json())
            .then(data => {
              // Assuming the response contains fields like name, email, etc.
              for (let key in data) {
                if (data.hasOwnProperty(key)) {
                  localStorage.setItem(key, data[key]);
                }
              }

              // Redirect to chat or study page after saving data in localStorage
              window.location.href = '/study.html?participantID=' + participantID;
            })
            .catch(error => {
              console.error('Error fetching participant data:', error);
              alert('Error fetching participant data. Please try again.');
            });
        });
      </script>
  </body>
</html>
